{
  "mock": {
    "valid_kms_key_existing_arn": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_existing_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_existing_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "no-op"
            ],
            "before": {
              "arn": "arn:aws:kms:eu-central-1:111111111111:key/e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "is_enabled": true,
              "key_id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "key_usage": "ENCRYPT_DECRYPT",
              "multi_region": false,
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\",\n  \t\t\"Condition\": {\n    \t\t\"StringEquals\": {\n      \t\t\t\"kms:ViaService\": [\n        \t\t\t\"es.eu-central-1.amazonaws.com\"\n      \t\t\t\t]\n    \t\t\t}\n  \t\t}\n\t}\n\t]\n}\n",
              "tags": {},
              "tags_all": {}
            },
            "after": {
              "arn": "arn:aws:kms:eu-central-1:111111111111:key/e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "is_enabled": true,
              "key_id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "key_usage": "ENCRYPT_DECRYPT",
              "multi_region": false,
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\",\n  \t\t\"Condition\": {\n    \t\t\"StringEquals\": {\n      \t\t\t\"kms:ViaService\": [\n        \t\t\t\"es.eu-central-1.amazonaws.com\"\n      \t\t\t\t]\n    \t\t\t}\n  \t\t}\n\t}\n\t]\n}\n",
              "tags": {},
              "tags_all": {}
            },
            "after_unknown": {},
            "before_sensitive": {
              "tags": {},
              "tags_all": {}
            },
            "after_sensitive": {
              "tags": {},
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": true,
                  "kms_key_id": "arn:aws:kms:eu-central-1:111111111111:key/e5e73038-da41-49ab-a8db-f7c8b1e46cbc"
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {}
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_existing_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_existing_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                },
                "policy": {
                  "references": [
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_region.current.name",
                    "data.aws_region.current"
                  ]
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": true
                    },
                    "kms_key_id": {
                      "constant_value": "arn:aws:kms:eu-central-1:111111111111:key/e5e73038-da41-49ab-a8db-f7c8b1e46cbc"
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "valid_kms_key_existing_id": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_existing_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_existing_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "no-op"
            ],
            "before": {
              "arn": "arn:aws:kms:eu-central-1:111111111111:key/e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "is_enabled": true,
              "key_id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "key_usage": "ENCRYPT_DECRYPT",
              "multi_region": false,
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\",\n  \t\t\"Condition\": {\n    \t\t\"StringEquals\": {\n      \t\t\t\"kms:ViaService\": [\n        \t\t\t\"es.eu-central-1.amazonaws.com\"\n      \t\t\t\t]\n    \t\t\t}\n  \t\t}\n\t}\n\t]\n}\n",
              "tags": {},
              "tags_all": {}
            },
            "after": {
              "arn": "arn:aws:kms:eu-central-1:111111111111:key/e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "is_enabled": true,
              "key_id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc",
              "key_usage": "ENCRYPT_DECRYPT",
              "multi_region": false,
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\",\n  \t\t\"Condition\": {\n    \t\t\"StringEquals\": {\n      \t\t\t\"kms:ViaService\": [\n        \t\t\t\"es.eu-central-1.amazonaws.com\"\n      \t\t\t\t]\n    \t\t\t}\n  \t\t}\n\t}\n\t]\n}\n",
              "tags": {},
              "tags_all": {}
            },
            "after_unknown": {},
            "before_sensitive": {
              "tags": {},
              "tags_all": {}
            },
            "after_sensitive": {
              "tags": {},
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": true,
                  "kms_key_id": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc"
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {}
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_existing_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_existing_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                },
                "policy": {
                  "references": [
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_region.current.name",
                    "data.aws_region.current"
                  ]
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": true
                    },
                    "kms_key_id": {
                      "constant_value": "e5e73038-da41-49ab-a8db-f7c8b1e46cbc"
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "valid_new_kms_key": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_new_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_new_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "is_enabled": true,
              "key_usage": "ENCRYPT_DECRYPT",
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\",\n  \t\t\"Condition\": {\n    \t\t\"StringEquals\": {\n      \t\t\t\"kms:ViaService\": [\n        \t\t\t\"es.eu-central-1.amazonaws.com\"\n      \t\t\t\t]\n    \t\t\t}\n  \t\t}\n\t}\n\t]\n}\n",
              "tags": null
            },
            "after_unknown": {
              "arn": true,
              "id": true,
              "key_id": true,
              "multi_region": true,
              "tags_all": true
            },
            "before_sensitive": false,
            "after_sensitive": {
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": true
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {
                  "kms_key_id": true
                }
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_new_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_new_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                },
                "policy": {
                  "references": [
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_region.current.name",
                    "data.aws_region.current"
                  ]
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": true
                    },
                    "kms_key_id": {
                      "references": [
                        "aws_kms_key.opensearch_new_key.arn",
                        "aws_kms_key.opensearch_new_key"
                      ]
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "undefined": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_new_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_new_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "is_enabled": true,
              "key_usage": "ENCRYPT_DECRYPT",
              "tags": null
            },
            "after_unknown": {
              "arn": true,
              "id": true,
              "key_id": true,
              "multi_region": true,
              "policy": true,
              "tags_all": true
            },
            "before_sensitive": false,
            "after_sensitive": {
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": true,
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_new_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_new_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "encryption_disabled": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_new_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_new_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "is_enabled": true,
              "key_usage": "ENCRYPT_DECRYPT",
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\",\n  \t\t\"Condition\": {\n    \t\t\"StringEquals\": {\n      \t\t\t\"kms:ViaService\": [\n        \t\t\t\"es.eu-central-1.amazonaws.com\"\n      \t\t\t\t]\n    \t\t\t}\n  \t\t}\n\t}\n\t]\n}\n",
              "tags": null
            },
            "after_unknown": {
              "arn": true,
              "id": true,
              "key_id": true,
              "multi_region": true,
              "tags_all": true
            },
            "before_sensitive": false,
            "after_sensitive": {
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": false
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {
                  "kms_key_id": true
                }
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_new_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_new_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                },
                "policy": {
                  "references": [
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_region.current.name",
                    "data.aws_region.current"
                  ]
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": false
                    },
                    "kms_key_id": {
                      "references": [
                        "aws_kms_key.opensearch_new_key.arn",
                        "aws_kms_key.opensearch_new_key"
                      ]
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "invalid_kms_key_with_no_condition": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_new_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_new_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "is_enabled": true,
              "key_usage": "ENCRYPT_DECRYPT",
              "policy": "  {\n    \"Id\": \"key-policy-opensesarch\",\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n    \t{\n            \"Sid\": \"Allow access for Key Administrators\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::111111111111:root\"\n            },\n            \"Action\": [\n                \"kms:Create*\",\n                \"kms:Describe*\",\n                \"kms:Enable*\",\n                \"kms:List*\",\n                \"kms:Put*\",\n                \"kms:Update*\",\n                \"kms:Revoke*\",\n                \"kms:Disable*\",\n                \"kms:Get*\",\n                \"kms:Delete*\",\n                \"kms:TagResource\",\n                \"kms:UntagResource\",\n                \"kms:ScheduleKeyDeletion\",\n                \"kms:CancelKeyDeletion\"\n            ],\n            \"Resource\": \"*\"\n        },\n  \t{\n  \t\t\"Effect\": \"Allow\",\n  \t\t\"Principal\": {\n    \t\t\t\"AWS\": \"arn:aws:iam::111111111111:user/janardhanm\"\n  \t\t},\n  \t\t\"Action\": [\n    \t\t\t\"kms:Encrypt\",\n    \t\t\t\"kms:Decrypt\",\n    \t\t\t\"kms:ReEncrypt*\",\n    \t\t\t\"kms:GenerateDataKey*\",\n    \t\t\t\"kms:CreateGrant\",\n    \t\t\t\"kms:ListGrants\",\n    \t\t\t\"kms:DescribeKey\"\n  \t\t\t],\n  \t\t\"Resource\": \"*\"\n\t}\n\t]\n}\n",
              "tags": null
            },
            "after_unknown": {
              "arn": true,
              "id": true,
              "key_id": true,
              "multi_region": true,
              "tags_all": true
            },
            "before_sensitive": false,
            "after_sensitive": {
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": true
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {
                  "kms_key_id": true
                }
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_new_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_new_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                },
                "policy": {
                  "references": [
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current",
                    "data.aws_caller_identity.current.account_id",
                    "data.aws_caller_identity.current"
                  ]
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": true
                    },
                    "kms_key_id": {
                      "references": [
                        "aws_kms_key.opensearch_new_key.arn",
                        "aws_kms_key.opensearch_new_key"
                      ]
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "invalid_kms_key_with_no_policy": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_new_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_new_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "is_enabled": true,
              "key_usage": "ENCRYPT_DECRYPT",
              "tags": null
            },
            "after_unknown": {
              "arn": true,
              "id": true,
              "key_id": true,
              "multi_region": true,
              "policy": true,
              "tags_all": true
            },
            "before_sensitive": false,
            "after_sensitive": {
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": true
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {
                  "kms_key_id": true
                }
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_new_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_new_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": true
                    },
                    "kms_key_id": {
                      "references": [
                        "aws_kms_key.opensearch_new_key.arn",
                        "aws_kms_key.opensearch_new_key"
                      ]
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    },
    "invalid_no_kms_key": {
      "resource_changes": [
        {
          "address": "aws_kms_key.opensearch_new_key",
          "mode": "managed",
          "type": "aws_kms_key",
          "name": "opensearch_new_key",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "bypass_policy_lockout_safety_check": false,
              "customer_master_key_spec": "SYMMETRIC_DEFAULT",
              "deletion_window_in_days": 10,
              "description": "Opensearch kms key",
              "enable_key_rotation": false,
              "is_enabled": true,
              "key_usage": "ENCRYPT_DECRYPT",
              "tags": null
            },
            "after_unknown": {
              "arn": true,
              "id": true,
              "key_id": true,
              "multi_region": true,
              "policy": true,
              "tags_all": true
            },
            "before_sensitive": false,
            "after_sensitive": {
              "tags_all": {}
            }
          }
        },
        {
          "address": "aws_opensearch_domain.example",
          "mode": "managed",
          "type": "aws_opensearch_domain",
          "name": "example",
          "provider_name": "registry.terraform.io/hashicorp/aws",
          "change": {
            "actions": [
              "create"
            ],
            "before": null,
            "after": {
              "cluster_config": [
                {
                  "dedicated_master_count": null,
                  "dedicated_master_enabled": false,
                  "dedicated_master_type": null,
                  "instance_count": 1,
                  "instance_type": "m3.medium.search",
                  "warm_count": null,
                  "warm_enabled": null,
                  "warm_type": null,
                  "zone_awareness_config": [],
                  "zone_awareness_enabled": null
                }
              ],
              "cognito_options": [],
              "domain_name": "exampledomain",
              "encrypt_at_rest": [
                {
                  "enabled": true
                }
              ],
              "engine_version": "OpenSearch_1.0",
              "log_publishing_options": [],
              "snapshot_options": [],
              "tags": null,
              "timeouts": null,
              "vpc_options": []
            },
            "after_unknown": {
              "access_policies": true,
              "advanced_options": true,
              "advanced_security_options": true,
              "arn": true,
              "auto_tune_options": true,
              "cluster_config": [
                {
                  "cold_storage_options": true,
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": true,
              "domain_id": true,
              "ebs_options": true,
              "encrypt_at_rest": [
                {
                  "kms_key_id": true
                }
              ],
              "endpoint": true,
              "id": true,
              "kibana_endpoint": true,
              "log_publishing_options": [],
              "node_to_node_encryption": true,
              "snapshot_options": [],
              "tags_all": true,
              "vpc_options": []
            },
            "before_sensitive": false,
            "after_sensitive": {
              "advanced_options": {},
              "advanced_security_options": [],
              "auto_tune_options": [],
              "cluster_config": [
                {
                  "cold_storage_options": [],
                  "zone_awareness_config": []
                }
              ],
              "cognito_options": [],
              "domain_endpoint_options": [],
              "ebs_options": [],
              "encrypt_at_rest": [
                {}
              ],
              "log_publishing_options": [],
              "node_to_node_encryption": [],
              "snapshot_options": [],
              "tags_all": {},
              "vpc_options": []
            }
          }
        }
      ],
      "configuration": {
        "provider_config": {
          "aws": {
            "name": "aws",
            "expressions": {
              "region": {
                "constant_value": "eu-central-1"
              }
            }
          }
        },
        "root_module": {
          "resources": [
            {
              "address": "aws_kms_key.opensearch_new_key",
              "mode": "managed",
              "type": "aws_kms_key",
              "name": "opensearch_new_key",
              "provider_config_key": "aws",
              "expressions": {
                "deletion_window_in_days": {
                  "constant_value": 10
                },
                "description": {
                  "constant_value": "Opensearch kms key"
                }
              },
              "schema_version": 0
            },
            {
              "address": "aws_opensearch_domain.example",
              "mode": "managed",
              "type": "aws_opensearch_domain",
              "name": "example",
              "provider_config_key": "aws",
              "expressions": {
                "cluster_config": [
                  {
                    "instance_type": {
                      "constant_value": "m3.medium.search"
                    }
                  }
                ],
                "domain_name": {
                  "constant_value": "exampledomain"
                },
                "encrypt_at_rest": [
                  {
                    "enabled": {
                      "constant_value": true
                    }
                  }
                ],
                "engine_version": {
                  "constant_value": "OpenSearch_1.0"
                }
              },
              "schema_version": 0
            },
            {
              "address": "data.aws_caller_identity.current",
              "mode": "data",
              "type": "aws_caller_identity",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            },
            {
              "address": "data.aws_region.current",
              "mode": "data",
              "type": "aws_region",
              "name": "current",
              "provider_config_key": "aws",
              "schema_version": 0
            }
          ]
        }
      }
    }
  }
}
