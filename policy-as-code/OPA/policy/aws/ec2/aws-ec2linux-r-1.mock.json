{
  "mock": {
    "valid": {
      "sg_by_ref":{
        "resource_changes": [
          {
            "address": "module.ec2.aws_instance.web",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_instance",
            "name": "web",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "ami": "ami-06cac34c3836ff90b",
                "credit_specification": [],
                "get_password_data": false,
                "hibernation": null,
                "iam_instance_profile": "test_profile",
                "instance_type": "t3.micro",
                "launch_template": [],
                "source_dest_check": true,
                "tags": {
                  "Name": "HelloWorld"
                },
                "tags_all": {
                  "Name": "HelloWorld"
                },
                "timeouts": null,
                "user_data_replace_on_change": false,
                "volume_tags": null
              },
              "after_unknown": {
                "arn": true,
                "associate_public_ip_address": true,
                "availability_zone": true,
                "capacity_reservation_specification": true,
                "cpu_core_count": true,
                "cpu_threads_per_core": true,
                "credit_specification": [],
                "disable_api_stop": true,
                "disable_api_termination": true,
                "ebs_block_device": true,
                "ebs_optimized": true,
                "enclave_options": true,
                "ephemeral_block_device": true,
                "host_id": true,
                "id": true,
                "instance_initiated_shutdown_behavior": true,
                "instance_state": true,
                "ipv6_address_count": true,
                "ipv6_addresses": true,
                "key_name": true,
                "launch_template": [],
                "maintenance_options": true,
                "metadata_options": true,
                "monitoring": true,
                "network_interface": true,
                "outpost_arn": true,
                "password_data": true,
                "placement_group": true,
                "placement_partition_number": true,
                "primary_network_interface_id": true,
                "private_dns": true,
                "private_dns_name_options": true,
                "private_ip": true,
                "public_dns": true,
                "public_ip": true,
                "root_block_device": true,
                "secondary_private_ips": true,
                "security_groups": true,
                "subnet_id": true,
                "tags": {},
                "tags_all": {},
                "tenancy": true,
                "user_data": true,
                "user_data_base64": true,
                "vpc_security_group_ids": true
              },
              "before_sensitive": false,
              "after_sensitive": {
                "capacity_reservation_specification": [],
                "credit_specification": [],
                "ebs_block_device": [],
                "enclave_options": [],
                "ephemeral_block_device": [],
                "ipv6_addresses": [],
                "launch_template": [],
                "maintenance_options": [],
                "metadata_options": [],
                "network_interface": [],
                "private_dns_name_options": [],
                "root_block_device": [],
                "secondary_private_ips": [],
                "security_groups": [],
                "tags": {},
                "tags_all": {},
                "vpc_security_group_ids": []
              }
            }
          },
          {
            "address": "module.ec2.aws_security_group.allow_tls",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "allow_tls",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "description": "Allow TLS inbound traffic",
                "egress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "",
                    "from_port": 0,
                    "ipv6_cidr_blocks": [
                      "::/0"
                    ],
                    "prefix_list_ids": [],
                    "protocol": "-1",
                    "security_groups": [],
                    "self": false,
                    "to_port": 0
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      "10.168.66.0/23"
                    ],
                    "description": "TLS from VPC",
                    "from_port": 443,
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "protocol": "tcp",
                    "security_groups": [],
                    "self": false,
                    "to_port": 443
                  }
                ],
                "name": "allow_tls",
                "revoke_rules_on_delete": false,
                "tags": {
                  "Name": "allow_tls"
                },
                "tags_all": {
                  "Name": "allow_tls"
                },
                "timeouts": null,
                "vpc_id": "vpc-088e7cfe76e655576"
              },
              "after_unknown": {
                "arn": true,
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "id": true,
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "name_prefix": true,
                "owner_id": true,
                "tags": {},
                "tags_all": {}
              },
              "before_sensitive": false,
              "after_sensitive": {
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "tags": {},
                "tags_all": {}
              }
            }
          }
        ],
        "configuration": {
          "root_module": {
            "module_calls": {
              "ec2": {
                "source": "./modules/ec2",
                "expressions": {
                  "vpc_id": {
                    "references": [
                      "var.vpc_id"
                    ]
                  }
                },
                "module": {
                  "resources": [
                    {
                      "address": "aws_instance.web",
                      "mode": "managed",
                      "type": "aws_instance",
                      "name": "web",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "ami": {
                          "references": [
                            "data.aws_ami.ubuntu.id",
                            "data.aws_ami.ubuntu"
                          ]
                        },
                        "iam_instance_profile": {
                          "references": [
                            "aws_iam_instance_profile.test_profile.name",
                            "aws_iam_instance_profile.test_profile"
                          ]
                        },
                        "instance_type": {
                          "constant_value": "t3.micro"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "HelloWorld"
                          }
                        },
                        "vpc_security_group_ids": {
                          "references": [
                            "aws_security_group.allow_tls.id",
                            "aws_security_group.allow_tls"
                          ]
                        }
                      },
                      "schema_version": 1
                    },
                    {
                      "address": "aws_security_group.allow_tls",
                      "mode": "managed",
                      "type": "aws_security_group",
                      "name": "allow_tls",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "description": {
                          "constant_value": "Allow TLS inbound traffic"
                        },
                        "egress": {
                          "constant_value": [
                            {
                              "cidr_blocks": [
                                "0.0.0.0/0"
                              ],
                              "description": null,
                              "from_port": 0,
                              "ipv6_cidr_blocks": [
                                "::/0"
                              ],
                              "prefix_list_ids": null,
                              "protocol": "-1",
                              "security_groups": null,
                              "self": null,
                              "to_port": 0
                            }
                          ]
                        },
                        "ingress": {
                          "references": [
                            "data.aws_vpc.selected.cidr_block",
                            "data.aws_vpc.selected"
                          ]
                        },
                        "name": {
                          "constant_value": "allow_tls"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "allow_tls"
                          }
                        },
                        "vpc_id": {
                          "references": [
                            "var.vpc_id"
                          ]
                        }
                      },
                      "schema_version": 1
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "sg_by_id":{
        "resource_changes": [
          {
            "address": "module.ec2.aws_instance.web",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_instance",
            "name": "web",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "ami": "ami-06cac34c3836ff90b",
                "credit_specification": [],
                "get_password_data": false,
                "hibernation": null,
                "iam_instance_profile": "test_profile",
                "instance_type": "t3.micro",
                "launch_template": [],
                "source_dest_check": true,
                "tags": {
                  "Name": "HelloWorld"
                },
                "tags_all": {
                  "Name": "HelloWorld"
                },
                "timeouts": null,
                "user_data_replace_on_change": false,
                "volume_tags": null
              },
              "after_unknown": {
                "arn": true,
                "associate_public_ip_address": true,
                "availability_zone": true,
                "capacity_reservation_specification": true,
                "cpu_core_count": true,
                "cpu_threads_per_core": true,
                "credit_specification": [],
                "disable_api_stop": true,
                "disable_api_termination": true,
                "ebs_block_device": true,
                "ebs_optimized": true,
                "enclave_options": true,
                "ephemeral_block_device": true,
                "host_id": true,
                "id": true,
                "instance_initiated_shutdown_behavior": true,
                "instance_state": true,
                "ipv6_address_count": true,
                "ipv6_addresses": true,
                "key_name": true,
                "launch_template": [],
                "maintenance_options": true,
                "metadata_options": true,
                "monitoring": true,
                "network_interface": true,
                "outpost_arn": true,
                "password_data": true,
                "placement_group": true,
                "placement_partition_number": true,
                "primary_network_interface_id": true,
                "private_dns": true,
                "private_dns_name_options": true,
                "private_ip": true,
                "public_dns": true,
                "public_ip": true,
                "root_block_device": true,
                "secondary_private_ips": true,
                "security_groups": true,
                "subnet_id": true,
                "tags": {},
                "tags_all": {},
                "tenancy": true,
                "user_data": true,
                "user_data_base64": true,
                "vpc_security_group_ids": true
              },
              "before_sensitive": false,
              "after_sensitive": {
                "capacity_reservation_specification": [],
                "credit_specification": [],
                "ebs_block_device": [],
                "enclave_options": [],
                "ephemeral_block_device": [],
                "ipv6_addresses": [],
                "launch_template": [],
                "maintenance_options": [],
                "metadata_options": [],
                "network_interface": [],
                "private_dns_name_options": [],
                "root_block_device": [],
                "secondary_private_ips": [],
                "security_groups": [],
                "tags": {},
                "tags_all": {},
                "vpc_security_group_ids": []
              }
            }
          },
          {
            "address": "module.ec2.aws_security_group.allow_tls",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "allow_tls",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "description": "Allow TLS inbound traffic",
                "egress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "",
                    "from_port": 0,
                    "ipv6_cidr_blocks": [
                      "::/0"
                    ],
                    "prefix_list_ids": [],
                    "protocol": "-1",
                    "security_groups": [],
                    "self": false,
                    "to_port": 0
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      "10.168.66.0/23"
                    ],
                    "description": "TLS from VPC",
                    "from_port": 443,
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "protocol": "tcp",
                    "security_groups": [],
                    "self": false,
                    "to_port": 443
                  }
                ],
                "name": "allow_tls",
                "revoke_rules_on_delete": false,
                "tags": {
                  "Name": "allow_tls"
                },
                "tags_all": {
                  "Name": "allow_tls"
                },
                "timeouts": null,
                "vpc_id": "vpc-088e7cfe76e655576"
              },
              "after_unknown": {
                "arn": true,
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "id": true,
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "name_prefix": true,
                "owner_id": true,
                "tags": {},
                "tags_all": {}
              },
              "before_sensitive": false,
              "after_sensitive": {
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "tags": {},
                "tags_all": {}
              }
            }
          }
        ],
        "configuration": {
          "root_module": {
            "module_calls": {
              "ec2": {
                "source": "./modules/ec2",
                "expressions": {
                  "vpc_id": {
                    "references": [
                      "var.vpc_id"
                    ]
                  }
                },
                "module": {
                  "resources": [
                    {
                      "address": "aws_instance.web",
                      "mode": "managed",
                      "type": "aws_instance",
                      "name": "web",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "ami": {
                          "references": [
                            "data.aws_ami.ubuntu.id",
                            "data.aws_ami.ubuntu"
                          ]
                        },
                        "iam_instance_profile": {
                          "references": [
                            "aws_iam_instance_profile.test_profile.name",
                            "aws_iam_instance_profile.test_profile"
                          ]
                        },
                        "instance_type": {
                          "constant_value": "t3.micro"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "HelloWorld"
                          }
                        },
                        "vpc_security_group_ids": {
                          "constant_value": [
                            "sg-1234567890"
                          ]
                        }
                      },
                      "schema_version": 1
                    },
                    {
                      "address": "aws_security_group.allow_tls",
                      "mode": "managed",
                      "type": "aws_security_group",
                      "name": "allow_tls",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "description": {
                          "constant_value": "Allow TLS inbound traffic"
                        },
                        "egress": {
                          "constant_value": [
                            {
                              "cidr_blocks": [
                                "0.0.0.0/0"
                              ],
                              "description": null,
                              "from_port": 0,
                              "ipv6_cidr_blocks": [
                                "::/0"
                              ],
                              "prefix_list_ids": null,
                              "protocol": "-1",
                              "security_groups": null,
                              "self": null,
                              "to_port": 0
                            }
                          ]
                        },
                        "ingress": {
                          "references": [
                            "data.aws_vpc.selected.cidr_block",
                            "data.aws_vpc.selected"
                          ]
                        },
                        "name": {
                          "constant_value": "allow_tls"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "allow_tls"
                          }
                        },
                        "vpc_id": {
                          "references": [
                            "var.vpc_id"
                          ]
                        }
                      },
                      "schema_version": 1
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "flat_sg_by_ref": {
        "resource_changes": [
          {
            "address": "aws_instance.web",
            "mode": "managed",
            "type": "aws_instance",
            "name": "web",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "ami": "ami-06cac34c3836ff90b",
                "credit_specification": [],
                "get_password_data": false,
                "hibernation": null,
                "iam_instance_profile": "test_profile",
                "instance_type": "t3.micro",
                "launch_template": [],
                "source_dest_check": true,
                "tags": {
                  "Name": "HelloWorld"
                },
                "tags_all": {
                  "Name": "HelloWorld"
                },
                "timeouts": null,
                "user_data_replace_on_change": false,
                "volume_tags": null
              },
              "after_unknown": {
                "arn": true,
                "associate_public_ip_address": true,
                "availability_zone": true,
                "capacity_reservation_specification": true,
                "cpu_core_count": true,
                "cpu_threads_per_core": true,
                "credit_specification": [],
                "disable_api_stop": true,
                "disable_api_termination": true,
                "ebs_block_device": true,
                "ebs_optimized": true,
                "enclave_options": true,
                "ephemeral_block_device": true,
                "host_id": true,
                "id": true,
                "instance_initiated_shutdown_behavior": true,
                "instance_state": true,
                "ipv6_address_count": true,
                "ipv6_addresses": true,
                "key_name": true,
                "launch_template": [],
                "maintenance_options": true,
                "metadata_options": true,
                "monitoring": true,
                "network_interface": true,
                "outpost_arn": true,
                "password_data": true,
                "placement_group": true,
                "placement_partition_number": true,
                "primary_network_interface_id": true,
                "private_dns": true,
                "private_dns_name_options": true,
                "private_ip": true,
                "public_dns": true,
                "public_ip": true,
                "root_block_device": true,
                "secondary_private_ips": true,
                "security_groups": true,
                "subnet_id": true,
                "tags": {},
                "tags_all": {},
                "tenancy": true,
                "user_data": true,
                "user_data_base64": true,
                "vpc_security_group_ids": true
              },
              "before_sensitive": false,
              "after_sensitive": {
                "capacity_reservation_specification": [],
                "credit_specification": [],
                "ebs_block_device": [],
                "enclave_options": [],
                "ephemeral_block_device": [],
                "ipv6_addresses": [],
                "launch_template": [],
                "maintenance_options": [],
                "metadata_options": [],
                "network_interface": [],
                "private_dns_name_options": [],
                "root_block_device": [],
                "secondary_private_ips": [],
                "security_groups": [],
                "tags": {},
                "tags_all": {},
                "vpc_security_group_ids": []
              }
            }
          },
          {
            "address": "aws_security_group.allow_tls",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "allow_tls",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "description": "Allow TLS inbound traffic",
                "egress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "",
                    "from_port": 0,
                    "ipv6_cidr_blocks": [
                      "::/0"
                    ],
                    "prefix_list_ids": [],
                    "protocol": "-1",
                    "security_groups": [],
                    "self": false,
                    "to_port": 0
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      "10.168.66.0/23"
                    ],
                    "description": "TLS from VPC",
                    "from_port": 443,
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "protocol": "tcp",
                    "security_groups": [],
                    "self": false,
                    "to_port": 443
                  }
                ],
                "name": "allow_tls",
                "revoke_rules_on_delete": false,
                "tags": {
                  "Name": "allow_tls"
                },
                "tags_all": {
                  "Name": "allow_tls"
                },
                "timeouts": null,
                "vpc_id": "vpc-088e7cfe76e655576"
              },
              "after_unknown": {
                "arn": true,
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "id": true,
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "name_prefix": true,
                "owner_id": true,
                "tags": {},
                "tags_all": {}
              },
              "before_sensitive": false,
              "after_sensitive": {
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "tags": {},
                "tags_all": {}
              }
            }
          }
        ],
        "configuration": {
          "root_module": {
            "resources": [
              {
                "address": "aws_instance.web",
                "mode": "managed",
                "type": "aws_instance",
                "name": "web",
                "provider_config_key": "aws",
                "expressions": {
                  "ami": {
                    "references": [
                      "data.aws_ami.ubuntu.id",
                      "data.aws_ami.ubuntu"
                    ]
                  },
                  "iam_instance_profile": {
                    "references": [
                      "aws_iam_instance_profile.test_profile.name",
                      "aws_iam_instance_profile.test_profile"
                    ]
                  },
                  "instance_type": {
                    "constant_value": "t3.micro"
                  },
                  "tags": {
                    "constant_value": {
                      "Name": "HelloWorld"
                    }
                  },
                  "vpc_security_group_ids": {
                    "references": [
                      "aws_security_group.allow_tls.id",
                      "aws_security_group.allow_tls"
                    ]
                  }
                },
                "schema_version": 1
              },
              {
                "address": "aws_security_group.allow_tls",
                "mode": "managed",
                "type": "aws_security_group",
                "name": "allow_tls",
                "provider_config_key": "aws",
                "expressions": {
                  "description": {
                    "constant_value": "Allow TLS inbound traffic"
                  },
                  "egress": {
                    "constant_value": [
                      {
                        "cidr_blocks": [
                          "0.0.0.0/0"
                        ],
                        "description": null,
                        "from_port": 0,
                        "ipv6_cidr_blocks": [
                          "::/0"
                        ],
                        "prefix_list_ids": null,
                        "protocol": "-1",
                        "security_groups": null,
                        "self": null,
                        "to_port": 0
                      }
                    ]
                  },
                  "ingress": {
                    "references": [
                      "data.aws_vpc.selected.cidr_block",
                      "data.aws_vpc.selected"
                    ]
                  },
                  "name": {
                    "constant_value": "allow_tls"
                  },
                  "tags": {
                    "constant_value": {
                      "Name": "allow_tls"
                    }
                  },
                  "vpc_id": {
                    "references": [
                      "var.vpc_id"
                    ]
                  }
                },
                "schema_version": 1
              }
            ]
          }
        }
      }
    },
    "invalid": {
      "open_rule": {
        "resource_changes": [
          {
            "address": "module.ec2.aws_instance.web",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_instance",
            "name": "web",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "ami": "ami-06cac34c3836ff90b",
                "credit_specification": [],
                "get_password_data": false,
                "hibernation": null,
                "iam_instance_profile": "test_profile",
                "instance_type": "t3.micro",
                "launch_template": [],
                "source_dest_check": true,
                "tags": {
                  "Name": "HelloWorld"
                },
                "tags_all": {
                  "Name": "HelloWorld"
                },
                "timeouts": null,
                "user_data_replace_on_change": false,
                "volume_tags": null
              },
              "after_unknown": {
                "arn": true,
                "associate_public_ip_address": true,
                "availability_zone": true,
                "capacity_reservation_specification": true,
                "cpu_core_count": true,
                "cpu_threads_per_core": true,
                "credit_specification": [],
                "disable_api_stop": true,
                "disable_api_termination": true,
                "ebs_block_device": true,
                "ebs_optimized": true,
                "enclave_options": true,
                "ephemeral_block_device": true,
                "host_id": true,
                "id": true,
                "instance_initiated_shutdown_behavior": true,
                "instance_state": true,
                "ipv6_address_count": true,
                "ipv6_addresses": true,
                "key_name": true,
                "launch_template": [],
                "maintenance_options": true,
                "metadata_options": true,
                "monitoring": true,
                "network_interface": true,
                "outpost_arn": true,
                "password_data": true,
                "placement_group": true,
                "placement_partition_number": true,
                "primary_network_interface_id": true,
                "private_dns": true,
                "private_dns_name_options": true,
                "private_ip": true,
                "public_dns": true,
                "public_ip": true,
                "root_block_device": true,
                "secondary_private_ips": true,
                "security_groups": true,
                "subnet_id": true,
                "tags": {},
                "tags_all": {},
                "tenancy": true,
                "user_data": true,
                "user_data_base64": true,
                "vpc_security_group_ids": true
              },
              "before_sensitive": false,
              "after_sensitive": {
                "capacity_reservation_specification": [],
                "credit_specification": [],
                "ebs_block_device": [],
                "enclave_options": [],
                "ephemeral_block_device": [],
                "ipv6_addresses": [],
                "launch_template": [],
                "maintenance_options": [],
                "metadata_options": [],
                "network_interface": [],
                "private_dns_name_options": [],
                "root_block_device": [],
                "secondary_private_ips": [],
                "security_groups": [],
                "tags": {},
                "tags_all": {},
                "vpc_security_group_ids": []
              }
            }
          },
          {
            "address": "module.ec2.aws_security_group.allow_tls",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "allow_tls",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "description": "Allow TLS inbound traffic",
                "egress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "",
                    "from_port": 0,
                    "ipv6_cidr_blocks": [
                      "::/0"
                    ],
                    "prefix_list_ids": [],
                    "protocol": "-1",
                    "security_groups": [],
                    "self": false,
                    "to_port": 0
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "TLS from VPC",
                    "from_port": 443,
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "protocol": "tcp",
                    "security_groups": [],
                    "self": false,
                    "to_port": 443
                  }
                ],
                "name": "allow_tls",
                "revoke_rules_on_delete": false,
                "tags": {
                  "Name": "allow_tls"
                },
                "tags_all": {
                  "Name": "allow_tls"
                },
                "timeouts": null,
                "vpc_id": "vpc-088e7cfe76e655576"
              },
              "after_unknown": {
                "arn": true,
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "id": true,
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "name_prefix": true,
                "owner_id": true,
                "tags": {},
                "tags_all": {}
              },
              "before_sensitive": false,
              "after_sensitive": {
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "tags": {},
                "tags_all": {}
              }
            }
          }
        ],
        "configuration": {
          "root_module": {
            "module_calls": {
              "ec2": {
                "source": "./modules/ec2",
                "module": {
                  "resources": [
                    {
                      "address": "aws_instance.web",
                      "mode": "managed",
                      "type": "aws_instance",
                      "name": "web",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "ami": {
                          "references": [
                            "data.aws_ami.ubuntu.id",
                            "data.aws_ami.ubuntu"
                          ]
                        },
                        "iam_instance_profile": {
                          "references": [
                            "aws_iam_instance_profile.test_profile.name",
                            "aws_iam_instance_profile.test_profile"
                          ]
                        },
                        "instance_type": {
                          "constant_value": "t3.micro"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "HelloWorld"
                          }
                        },
                        "vpc_security_group_ids": {
                          "references": [
                            "aws_security_group.allow_tls.id",
                            "aws_security_group.allow_tls"
                          ]
                        }
                      },
                      "schema_version": 1
                    },
                    {
                      "address": "aws_security_group.allow_tls",
                      "mode": "managed",
                      "type": "aws_security_group",
                      "name": "allow_tls",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "description": {
                          "constant_value": "Allow TLS inbound traffic"
                        },
                        "egress": {
                          "constant_value": [
                            {
                              "cidr_blocks": [
                                "0.0.0.0/0"
                              ],
                              "description": null,
                              "from_port": 0,
                              "ipv6_cidr_blocks": [
                                "::/0"
                              ],
                              "prefix_list_ids": null,
                              "protocol": "-1",
                              "security_groups": null,
                              "self": null,
                              "to_port": 0
                            }
                          ]
                        },
                        "ingress": {
                          "constant_value": [
                            {
                              "cidr_blocks": [
                                "0.0.0.0/0"
                              ],
                              "description": "TLS from VPC",
                              "from_port": 443,
                              "ipv6_cidr_blocks": null,
                              "prefix_list_ids": null,
                              "protocol": "tcp",
                              "security_groups": null,
                              "self": null,
                              "to_port": 443
                            }
                          ]
                        },
                        "name": {
                          "constant_value": "allow_tls"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "allow_tls"
                          }
                        },
                        "vpc_id": {
                          "references": [
                            "var.vpc_id"
                          ]
                        }
                      },
                      "schema_version": 1
                    }
                  ]
                }
              }
            }
          }
        }
      },
      "no_sg": {
        "resource_changes": [
          {
            "address": "module.ec2.aws_instance.web",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_instance",
            "name": "web",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "ami": "ami-06cac34c3836ff90b",
                "credit_specification": [],
                "get_password_data": false,
                "hibernation": null,
                "iam_instance_profile": "test_profile",
                "instance_type": "t3.micro",
                "launch_template": [],
                "source_dest_check": true,
                "tags": {
                  "Name": "HelloWorld"
                },
                "tags_all": {
                  "Name": "HelloWorld"
                },
                "timeouts": null,
                "user_data_replace_on_change": false,
                "volume_tags": null
              },
              "after_unknown": {
                "arn": true,
                "associate_public_ip_address": true,
                "availability_zone": true,
                "capacity_reservation_specification": true,
                "cpu_core_count": true,
                "cpu_threads_per_core": true,
                "credit_specification": [],
                "disable_api_stop": true,
                "disable_api_termination": true,
                "ebs_block_device": true,
                "ebs_optimized": true,
                "enclave_options": true,
                "ephemeral_block_device": true,
                "host_id": true,
                "id": true,
                "instance_initiated_shutdown_behavior": true,
                "instance_state": true,
                "ipv6_address_count": true,
                "ipv6_addresses": true,
                "key_name": true,
                "launch_template": [],
                "maintenance_options": true,
                "metadata_options": true,
                "monitoring": true,
                "network_interface": true,
                "outpost_arn": true,
                "password_data": true,
                "placement_group": true,
                "placement_partition_number": true,
                "primary_network_interface_id": true,
                "private_dns": true,
                "private_dns_name_options": true,
                "private_ip": true,
                "public_dns": true,
                "public_ip": true,
                "root_block_device": true,
                "secondary_private_ips": true,
                "security_groups": true,
                "subnet_id": true,
                "tags": {},
                "tags_all": {},
                "tenancy": true,
                "user_data": true,
                "user_data_base64": true,
                "vpc_security_group_ids": true
              },
              "before_sensitive": false,
              "after_sensitive": {
                "capacity_reservation_specification": [],
                "credit_specification": [],
                "ebs_block_device": [],
                "enclave_options": [],
                "ephemeral_block_device": [],
                "ipv6_addresses": [],
                "launch_template": [],
                "maintenance_options": [],
                "metadata_options": [],
                "network_interface": [],
                "private_dns_name_options": [],
                "root_block_device": [],
                "secondary_private_ips": [],
                "security_groups": [],
                "tags": {},
                "tags_all": {},
                "vpc_security_group_ids": []
              }
            }
          },
          {
            "address": "module.ec2.aws_security_group.allow_tls",
            "module_address": "module.ec2",
            "mode": "managed",
            "type": "aws_security_group",
            "name": "allow_tls",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
              "actions": [
                "create"
              ],
              "before": null,
              "after": {
                "description": "Allow TLS inbound traffic",
                "egress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "",
                    "from_port": 0,
                    "ipv6_cidr_blocks": [
                      "::/0"
                    ],
                    "prefix_list_ids": [],
                    "protocol": "-1",
                    "security_groups": [],
                    "self": false,
                    "to_port": 0
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      "0.0.0.0/0"
                    ],
                    "description": "TLS from VPC",
                    "from_port": 443,
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "protocol": "tcp",
                    "security_groups": [],
                    "self": false,
                    "to_port": 443
                  }
                ],
                "name": "allow_tls",
                "revoke_rules_on_delete": false,
                "tags": {
                  "Name": "allow_tls"
                },
                "tags_all": {
                  "Name": "allow_tls"
                },
                "timeouts": null,
                "vpc_id": "vpc-088e7cfe76e655576"
              },
              "after_unknown": {
                "arn": true,
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "id": true,
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "name_prefix": true,
                "owner_id": true,
                "tags": {},
                "tags_all": {}
              },
              "before_sensitive": false,
              "after_sensitive": {
                "egress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [
                      false
                    ],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "ingress": [
                  {
                    "cidr_blocks": [
                      false
                    ],
                    "ipv6_cidr_blocks": [],
                    "prefix_list_ids": [],
                    "security_groups": []
                  }
                ],
                "tags": {},
                "tags_all": {}
              }
            }
          }
        ],
        "configuration": {
          "root_module": {
            "module_calls": {
              "ec2": {
                "source": "./modules/ec2",
                "expressions": {
                  "vpc_id": {
                    "references": [
                      "var.vpc_id"
                    ]
                  }
                },
                "module": {
                  "resources": [
                    {
                      "address": "aws_iam_instance_profile.test_profile",
                      "mode": "managed",
                      "type": "aws_iam_instance_profile",
                      "name": "test_profile",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "name": {
                          "constant_value": "test_profile"
                        },
                        "role": {
                          "references": [
                            "aws_iam_role.role.name",
                            "aws_iam_role.role"
                          ]
                        }
                      },
                      "schema_version": 0
                    },
                    {
                      "address": "aws_iam_role.role",
                      "mode": "managed",
                      "type": "aws_iam_role",
                      "name": "role",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "assume_role_policy": {
                          "constant_value": "{\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Action\": \"sts:AssumeRole\",\r\n            \"Principal\": {\r\n               \"Service\": \"ec2.amazonaws.com\"\r\n            },\r\n            \"Effect\": \"Allow\",\r\n            \"Sid\": \"\"\r\n        }\r\n    ]\r\n}\r\n"
                        },
                        "name": {
                          "constant_value": "test_role"
                        },
                        "path": {
                          "constant_value": "/"
                        }
                      },
                      "schema_version": 0
                    },
                    {
                      "address": "aws_instance.web",
                      "mode": "managed",
                      "type": "aws_instance",
                      "name": "web",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "ami": {
                          "references": [
                            "data.aws_ami.ubuntu.id",
                            "data.aws_ami.ubuntu"
                          ]
                        },
                        "iam_instance_profile": {
                          "references": [
                            "aws_iam_instance_profile.test_profile.name",
                            "aws_iam_instance_profile.test_profile"
                          ]
                        },
                        "instance_type": {
                          "constant_value": "t3.micro"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "HelloWorld"
                          }
                        }
                      },
                      "schema_version": 1
                    },
                    {
                      "address": "aws_security_group.allow_tls",
                      "mode": "managed",
                      "type": "aws_security_group",
                      "name": "allow_tls",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "description": {
                          "constant_value": "Allow TLS inbound traffic"
                        },
                        "egress": {
                          "constant_value": [
                            {
                              "cidr_blocks": [
                                "0.0.0.0/0"
                              ],
                              "description": null,
                              "from_port": 0,
                              "ipv6_cidr_blocks": [
                                "::/0"
                              ],
                              "prefix_list_ids": null,
                              "protocol": "-1",
                              "security_groups": null,
                              "self": null,
                              "to_port": 0
                            }
                          ]
                        },
                        "ingress": {
                          "constant_value": [
                            {
                              "cidr_blocks": [
                                "0.0.0.0/0"
                              ],
                              "description": "TLS from VPC",
                              "from_port": 443,
                              "ipv6_cidr_blocks": null,
                              "prefix_list_ids": null,
                              "protocol": "tcp",
                              "security_groups": null,
                              "self": null,
                              "to_port": 443
                            }
                          ]
                        },
                        "name": {
                          "constant_value": "allow_tls"
                        },
                        "tags": {
                          "constant_value": {
                            "Name": "allow_tls"
                          }
                        },
                        "vpc_id": {
                          "references": [
                            "var.vpc_id"
                          ]
                        }
                      },
                      "schema_version": 1
                    },
                    {
                      "address": "data.aws_ami.ubuntu",
                      "mode": "data",
                      "type": "aws_ami",
                      "name": "ubuntu",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "filter": [
                          {
                            "name": {
                              "constant_value": "name"
                            },
                            "values": {
                              "constant_value": [
                                "ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*"
                              ]
                            }
                          },
                          {
                            "name": {
                              "constant_value": "virtualization-type"
                            },
                            "values": {
                              "constant_value": [
                                "hvm"
                              ]
                            }
                          }
                        ],
                        "most_recent": {
                          "constant_value": true
                        },
                        "owners": {
                          "constant_value": [
                            "099720109477"
                          ]
                        }
                      },
                      "schema_version": 0
                    },
                    {
                      "address": "data.aws_vpc.selected",
                      "mode": "data",
                      "type": "aws_vpc",
                      "name": "selected",
                      "provider_config_key": "ec2:aws",
                      "expressions": {
                        "id": {
                          "references": [
                            "var.vpc_id"
                          ]
                        }
                      },
                      "schema_version": 0
                    }
                  ],
                  "variables": {
                    "vpc_id": {}
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}